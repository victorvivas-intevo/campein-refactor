<div [class]="styles + ` w-full overflow-hidden`">
  <table class="w-full table-auto border-collapse">
    <thead class="">
      <tr class="border-b border-gray-200 cursor-pointer bg-head-table-bg">
        <th
          *ngFor="let col of columns"
          class="text-center p-2 font-semibold"
          [class.sortable]="isSortable(col)"
          (click)="onHeaderClick(col)"
        >
          <div class="flex gap-2 items-center">
            <span>{{ col.header }}</span>

            @if (isSortable(col)) {
              <i class="" [ngClass]="getSortIconClass(col)"></i>
            }
          </div>
        </th>

        @if (rowActions.length) {
          <th class="text-center p-2">Acciones</th>
        }
      </tr>
    </thead>

    <tbody>
      @for (row of displayRows; track $index) {
        <tr
          class="border-b border-slate-200"
          [ngClass]="{
            'hover:bg-primary-green-50 odd:bg-gray-50 even:bg-white': !isSelected(row),
            'bg-primary-red-300 ring-1 ring-primary-green-300': isSelected(row),
          }"
        >
          @for (col of columns; track $index) {
            <td class="p-2 font-normal bg-transparent" [ngClass]="getCellAlignClass(col)">
              <span
                [class]="
                  col.cellClass
                    ? `px-2 py-1 rounded-full text-sm font-medium ${col.cellClass(getCellValueRaw(row, col), row)}`
                    : ''
                "
              >
                @if (col.type == 'date') {
                  {{ getCellValue(row, col) | date: 'yyyy-MM-dd' }}
                } @else {
                  {{
                    col.formatter
                      ? col.formatter(getCellValueRaw(row, col), row)
                      : getCellValueRaw(row, col)
                  }}
                }
              </span>
            </td>
          }
          @if (rowActions.length) {
            <td>
              <div class="w-full flex gap-2 justify-center">
                @for (action of rowActions; track $index) {
                  @if (shouldShowAction(action, row)) {
                    <button
                      type="button"
                      [class]="
                        (isSelected(row) && action.selectsRow && action.activeVariant
                          ? action.activeVariant.classList
                          : action.variant?.classList) +
                        ' cursor-pointer px-1.5 py-1 rounded-full transition-colors ease-in-out duration-100'
                      "
                      (click)="onRowActionClick(action, row, $event)"
                    >
                      @if (action.iconClass) {
                        <i
                          class="action-icon"
                          [ngClass]="
                            isSelected(row) && action.selectsRow && action.activeIconClass
                              ? action.activeIconClass
                              : action.iconClass
                          "
                          aria-hidden="true"
                        >
                        </i>
                      }
                    </button>
                  }
                }
              </div>
            </td>
          }
        </tr>
      }
      @if (!displayRows.length) {
        <tr>
          <td
            class="text-center text-gray-500 py-6"
            [attr.colspan]="columns.length + (rowActions.length ? 1 : 0)"
          >
            No hay registros para mostrar.
          </td>
        </tr>
      }
    </tbody>
  </table>

  @if (config.pagination?.enabled) {
    <div
      class="pagination-wrapper flex flex-col sm:flex-row justify-between items-center py-3 mt-2 gap-4"
    >
      <div class="flex items-center gap-2 text-sm text-gray-600">
        <label for="pageSize" class="font-medium">Mostrar:</label>
        <select
          id="pageSize"
          class="border border-gray-300 rounded-md px-2 py-1 bg-white focus:outline-none focus:ring-1 focus:ring-primary-green-300 text-sm cursor-pointer"
          (change)="onPageSizeChange($event)"
        >
          @for (size of pageSizeOptions; track size) {
            <option [value]="size" [selected]="size === config.pagination?.pageSize">{{ size }} registros</option>
          }
        </select>
      </div>

      <div class="flex items-center gap-4">
        <button
          type="button"
          class="pagination-btn cursor-pointer px-3 py-1 rounded-md border border-gray-300 bg-white text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
          (click)="prevPage()"
          [disabled]="currentPage === 1"
        >
          Anterior
        </button>

        <span class="pagination-info text-sm text-gray-600 font-medium">
          PÃ¡gina {{ currentPage }} de {{ totalPages }}
        </span>

        <button
          type="button"
          class="pagination-btn cursor-pointer px-3 py-1 rounded-md border border-gray-300 bg-white text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
          (click)="nextPage()"
          [disabled]="currentPage === totalPages || totalPages === 0"
        >
          Siguiente
        </button>
      </div>
    </div>
  }
</div>
